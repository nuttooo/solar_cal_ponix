# CSV File Format Requirements for Solar Analyzer Pro

## รูปแบบไฟล์ CSV ที่ต้องการ

### ข้อกำหนดพื้นฐาน
- ไฟล์ต้องเป็นนามสกุล `.csv`
- ใช้รูปแบบ CSV มาตรฐาน (comma-separated values)
- ข้อมูลต้องเป็นกำลังไฟฟ้า (Power) ในหน่วยกิโลวัตต์ (kW)
- ชื่อไฟล์สามารถเป็นชื่อใดก็ได้ ไม่จำเป็นต้องเป็น `kw.csv` เสมอไป

### โครงสร้างไฟล์

#### Header Row (แถวแรก)
```
,RATE A,,RATE B,,RATE C,
```
- มี 6 คอลัมน์ (column A, B, C, D, E, F)
- RATE A, RATE B, RATE C คืออัตราค่าไฟฟ้าที่แตกต่างกัน
- คอลัมน์ว่างระหว่าง RATE ใช้สำหรับแยกข้อมูล

#### Data Rows (แถวข้อมูล)
```
08/06/2025 00.15,,,,,189,
08/06/2025 00.30,,,,,180,
08/06/2025 00.45,,,,,165,
...
```

### รูปแบบวันที่และเวลา
- **รูปแบบ**: `DD/MM/YYYY HH.MM`
  - DD: วัน (2 หลัก)
  - MM: เดือน (2 หลัก)
  - YYYY: ปี (4 หลัก)
  - HH: ชั่วโมง (24 ชั่วโมง)
  - MM: นาที (15 นาที = 15, 30 นาที = 30, 45 นาที = 45)

### ข้อมูลกำลังไฟฟ้า (Power Data)
- ค่าในแต่ละคอลัมน์ RATE คือข้อมูลกำลังไฟฟ้า (kW)
- บันทึกทุก 15 นาที (96 ค่าต่อวัน)
- ค่าที่เป็น empty หมายถึงไม่มีการใช้งานในช่วงเวลา/อัตรานั้น

### ตัวอย่างข้อมูลที่ถูกต้อง
```csv
,RATE A,,RATE B,,RATE C,
08/06/2025 00.15,,,,,189,
08/06/2025 00.30,,,,,180,
08/06/2025 00.45,,,,,165,
08/06/2025 01.00,,,,,165,
08/06/2025 01.15,,,,,165,
08/06/2025 01.30,,,,,177,
08/06/2025 01.45,,,,,171,
08/06/2025 02.00,,,,,177,
...
09/06/2025 09.15,150,,,,,
09/06/2025 09.30,132,,,,,
09/06/2025 09.45,144,,,,,
...
```

### ข้อควรทราบ
1. **ชื่อไฟล์**: ไม่จำเป็นต้องเป็น `kw.csv` สามารถใช้ชื่อใดก็ได้ที่ลงท้ายด้วย `.csv`
2. **Encoding**: ควรใช้ UTF-8 เพื่อรองรับภาษาไทย (ถ้ามี)
3. **ขนาดไฟล์**: สนับสนุนไฟล์ขนาดสูงสุด 16MB
4. **ระยะเวลา**: ควรมีข้อมูลอย่างน้อย 1 วัน (96 แถว) เพื่อการวิเคราะห์ที่มีความหมาย
5. **ข้อมูลสูญหาย**: หากมีข้อมูลสูญหายบางช่วง ระบบจะพยายามประมาณค่าโดยอัตโนมัติ

### การตรวจสอบความถูกต้อง
- ตรวจสอบว่ามี header row ที่ถูกต้อง
- ตรวจสอบรูปแบบวันที่และเวลา
- ตรวจสอบว่าข้อมูลเป็นตัวเลข (kW)
- ตรวจสอบว่าไม่มีค่าว่างที่ไม่จำเป็น

### การเตรียมข้อมูลจากระบบอื่น
หากมีข้อมูลจากระบบอื่น สามารถแปลงเป็นรูปแบบที่ต้องการได้โดย:
1. ส่งออกข้อมูลเป็น CSV
2. จัดรูปแบบคอลัมน์ให้ตรงตามที่กำหนด
3. แปลงรูปแบบวันที่เวลาให้ถูกต้อง
4. ตรวจสอบข้อมูลก่อนอัปโหลด